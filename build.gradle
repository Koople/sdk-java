plugins {
    id 'java'
    id 'maven-publish'
}

configurations.all {
    // check for updates every build for dependencies with: 'changing: true'
    resolutionStrategy.cacheChangingModulesFor 0, 'seconds'
}

repositories {
    mavenLocal()
    mavenCentral()
}

allprojects {
    group = 'com.fflags'
    version = "${version}"
    sourceCompatibility = 1.7
    targetCompatibility = 1.7
}

ext.libraries = [:]

// Add dependencies to "libraries.internal" that are not exposed in our public API. These
// will be completely omitted from the "thin" jar, and will be embedded with shaded names
// in the other two SDK jars.
libraries.internal = [
        "com.google.guava:guava:28.1-jre"
]

// Add dependencies to "libraries.external" that are exposed in our public API, or that have
// global state that must be shared between the SDK and the caller.
libraries.external = [
        "com.google.code.gson:gson:2.7",
        "org.slf4j:slf4j-api:1.7.21",
        "com.pataflags:evaluator:1.0-SNAPSHOT"
]

// Add dependencies to "libraries.test" that are used only in unit tests.
libraries.test = [
        "com.squareup.okhttp3:mockwebserver:4.3.0",
        "org.easymock:easymock:4.1",
        "junit:junit:4.13",
        "ch.qos.logback:logback-classic:1.2.3"
]

dependencies {
    implementation libraries.internal
    compileClasspath libraries.external
    runtime libraries.external, libraries.internal
    testImplementation libraries.test, libraries.internal
}

test {
    testLogging {
        events "passed", "skipped", "failed", "standardOut", "standardError"
        showStandardStreams = true
        exceptionFormat = 'full'
    }
}


